<head>
  <title>Búsqueda pacientes</title>
  <link rel="stylesheet" href="search.component.css" />
</head>
<div class="content">
  <form [formGroup]="patientForm">
    <mat-card-title> {{ title }}</mat-card-title>
    <mat-card-content>
      <div class="credentials">
        <mat-form-field appearance="outline">
          <mat-label>Código:</mat-label>
          <input
            matInput
            type="text"
            id="patientID"
            formControlName="patientCode"
          />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label for="name">Nombre:</mat-label>
          <input matInput type="text" id="name" formControlName="name" />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label for="surname1">Apellido 1:</mat-label>
          <input
            matInput
            type="text"
            id="surname1"
            formControlName="surname1"
          />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label for="surname2">Apellido 2:</mat-label>
          <input
            matInput
            type="text"
            id="surname2"
            formControlName="surname2"
          />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label for="dni">DNI/NIE:</mat-label>
          <input matInput type="text" id="dni" formControlName="dni" />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label for="numSS">CIP:</mat-label>
          <input matInput type="text" id="numSS" formControlName="cip" />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label for="phone" class="telf">Teléfono:</mat-label>
          <input matInput type="text" id="phone" formControlName="phone" />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Zona: </mat-label>
          <mat-select formControlName="ingresados">
            <mat-option *ngFor="let zone of hospitalZones">
              {{ zone.value | enumToString: 'HOSPITAL_ZONE' }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </mat-card-content>
    <button type="submit" (click)="onSubmit()" (click)="toggleDisplay()">
      Buscar
    </button>
  </form>
  <br />
  <div
    [style.display]="isVisible ? 'block' : 'none'"
    *ngIf="patients.length <= 0"
  >
    <legend style="margin-left: 3%">Paciente no encontrado</legend>
  </div>
  <div
    class="table-wrapper"
    [style.display]="isVisible ? 'block' : 'none'"
    *ngIf="patients.length > 0"
  >
    <table>
      <thead>
        <th>Código</th>
        <th>Nombre</th>
        <th>Apellido 1</th>
        <th>Apellido 2</th>
        <th>Teléfono</th>
        <!--<th>Edad</th>-->
        <th>Estado</th>
        <th>Id. Cama</th>
        <th>Ficha</th>
      </thead>
      <tbody>
        <tr
          *ngFor="let patient of patients"
          (click)="goToManage(patient.id)"
          class="clickable-row"
        >
          <td>{{ patient.patientCode }}</td>
          <td>{{ patient.name }}</td>
          <td>{{ patient.surname1 }}</td>
          <td>{{ patient.surname2 }}</td>
          <td>{{ patient.phone }}</td>
          <!--<td>{{ patient.age }}</td>-->
          <td>
            {{
              patient.status | enumToString : "HOSPITAL_ZONE"
            }}
          </td>
          <td>{{ patient.bedId }}</td>
          <td (click)="$event.stopPropagation()">
            <button mat-button (click)="openDialog(patient.patientCode)">
              Abrir
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
